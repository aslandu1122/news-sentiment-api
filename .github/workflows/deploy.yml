name: ğŸš€ ä½¿ç”¨ Python SDK éƒ¨ç½²è‡³è…¾è®¯äº‘ SCF

on:
  push:
    branches: [ main ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ”„ æ£€å‡ºä»£ç 
        uses: actions/checkout@v3

      - name: ğŸ è®¾ç½® Python ç¯å¢ƒ
        uses: actions/setup-python@v4
        with:
          python-version: '3.8'

      - name: ğŸ“¦ å®‰è£…è…¾è®¯äº‘ Python SDK
        run: pip install tencentcloud-sdk-python

      - name: ğŸ“ å‡†å¤‡éƒ¨ç½²åŒ…
        run: |
          # åˆ›å»ºéƒ¨ç½²åŒ…ï¼Œç¡®ä¿åŒ…å«ä½ çš„ä»£ç æ–‡ä»¶
          zip -r function.zip sentiment_analysis.py requirements.txt
          echo "éƒ¨ç½²åŒ…åˆ›å»ºå®Œæˆï¼Œå†…å®¹å¦‚ä¸‹ï¼š"
          unzip -l function.zip

      - name: â¬†ï¸ æ‰§è¡Œéƒ¨ç½²è„šæœ¬
        env:
          TENCENT_SECRET_ID: ${{ secrets.TENCENT_SECRET_ID }}
          TENCENT_SECRET_KEY: ${{ secrets.TENCENT_SECRET_KEY }}
        run: |
          # è¿è¡Œæˆ‘ä»¬åˆ›å»ºçš„ç‹¬ç«‹ Python è„šæœ¬
          python deploy_function.py
